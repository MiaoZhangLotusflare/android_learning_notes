# HAL 的经济意义

# 1. HAL 框架的角色

![](image/HAL.png)

![](image/驱动模式.png)

![](image/HAL框架.png)

![](image/HALDriver.png)

# 2. HAL 的商业意义

* Android 驱动专家，Jollen Chen 说道：
* HAL stub 软件可封闭源码，因此也较利于商业模式推展。
* 提供关键 IC 零组件封闭原始码的 HAL stub软件(Proprietary software)。 
* 不但是「软硬整合」，也是 Android 绑定硬件平台的一种策略。

![](image/设定驱动.png)

## 没钱就改版

* 万里长城，是为了关内居民的安居乐业。
* 应用框架 (Framework) 的存在，是为了底层模块的「没钱就改版，改版就有钱」。
* Android 的存在，是为了『容易』实现「没钱就改版，改版就有钱」。
* 驱动开发者 ( 硬件供货商 ) 拥有自由度 (容易改版)，乐意替 Google 抬轿。
* 关内居民拥有高自由度 ( 不受制于北方游牧民族 )，乐意拥戴皇上。
* Google 让驱动变动不牵动上层，没有涟漪效应，变动成本低，客户愿意改版，带来改版机会。

![](image/创造利润.png)

* 万里长城，是为了关内居民的安居乐业。
* 应用框架 (Framework) 的存在，是为了底层模块的「没钱就改版，改版就有钱」。
* Android 的存在，是为了『容易』实现「没钱就改版，改版就有钱」。
* Google 为了获得底层供货商的支持 ( 即商业应用)，避开 GPL 的限制，将驱动程序移到 User Space；于是驱动开发者 ( 底层供货商 ) 就有利可图 ( 有机会改版，又能收钱 )。 
* 因而日益茁壮，大力支持 Google，强龙(盟主)地位自然形成。

![](image/gpl.png)

## 架构设计与商业利益

* HAL 框架的设计可吸引硬件厂商，削弱 Linux 对硬件厂商的约束力。
* 有架空 Linux 基金会的味道。
* 框架设计不在于框架内部类别的多少或内涵的复杂性，而在于接口的制定权。
* 简单的 HAL 框架设计，改变了 Google、Linux 基金会和硬件厂商之间三角的商业利益关系。

# 3. 框架设计：维护底层的变动自由度

* 底层指的就是 Driver，驱动。

* 过去的架构设计，大多要求下层平台呈现稳定，来稳固支撑上层(如App)业务流程的多变化。
* 今天流行的框架设计，则反过来以接口 ( Inteface ) 掌控App，而力求创造底层模块 ( 包括 Windows 等平台 ) 的变动自由度。
* 应用框架（App 框架）：是一种框架（架构）-> 用来框住 App。
* 最著名的微软 .NET 框架

![](image/net框架.png)

* Android 提供多层级的框架体系

![](image/java框架.png)

## 古典观点（视角）

![](image/古典观点.png)

* 底层提供服务给上层调用。
* User 希望 AP 稳定不变。
* AP 希望 Java 框架不变。
*  Java 框架期待 C/C++ 模块不变。
* C/C++ 模块期待驱动稳定不变。
* 人人都期待底下的 “ 平台 ” 不变。

## 新观点

![](image/新观点.png)

* 框架 (Framework) 是萬里長城，API 就是關口(如山海關)。在秦國、漢時代，就是為了 < 抵抗 > 北方強敵，所以 < 不得不 > 舉全國之力築城防禦。
* 维护关内居民的自由度 ( 不受北方干扰 )。

## 设计范例

![](image/我的平台.png)

* 曹操类可以保护 < 我的平台 > 的变动自由度和稳定性。

![](image/曹操类.png)

* 當我們把多個曹操類集合起來，就成為一個平台框架 (Framework) 了。

![](image/平台框架.png)

* 把 App 设计成为框架 \<E&I\> 的插件 \<T\>。

![](image/app.png)

* 框架是中间件（Middleware）的代码框架

![](image/中间件.png)

### HAL 框架的角色

![](image/hal角色1.png)

![](image/hal角色2.png)

![](image/hal角色3.png)