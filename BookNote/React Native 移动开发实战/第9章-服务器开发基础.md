# 第 9 章 服务器开发基础

​		常见的服务器端开发语言和技术主要有以下几种。

* 基于 Java 的 Spring 技术
* 基于 Ruby 的 Ruby on Rails 技术
* 基于 Python 的 Django Web 技术
* 基于 JavaScript 的 Node.js 技术
* 常用的 PHP 和 ASP 等技术

## 9.1. Node.js 开发

### 9.1.1. Node.js 简介

​		所谓脚本语言，就是在程序执行之前，不需要编译就可以直接运行的语言，因为脚本语言具有边解析、边执行的能力。

​		在传统的网页开发中，对于嵌套在 HTML 页面里的 JavaScript 代码，浏览器就是 JavaScript 代码的解析器。而对于独立运行的 JavaScript 代码，Node.js 则充当了解析器的角色。

​		Node.js 作为 JavaScript 的运行环境，为 JavaScript 提供了操作文件、创建 HTTP 服务、创建 TCP/UDP 服务等接口，所以 Node.js 可以实现其他后台语言的工作。

​		简单来说，Node.js 是一个基于 Chrome V8 引擎的 JavaScript 运行环境，由于 Node.js 让 JavaScript 具备了在服务器端运行的能力，所以前端开发者可以使用它快速创建高可扩展性的服务器应用。

​		Node.js 使用异步 I/O 和事件驱动代替多线程，从而带来了很大的性能提升，因此 Node.js 非常适合用来构建运行在分布式设备的数据密集型实时应用。另外，使用强大的 Google V8 JavaScript 引擎的同时，Node.js 还使用了高效的 libev 和 libeio 库支持事件驱动和异步 I/O 操作。

### 9.1.2. 安装和使用 nvm

​		nvm 是一个 Node.js 的多版本管理工具，可以帮助开发者轻易实现多个 Node.js 版本之间切换。

### 9.1.3. Node.js 示例

​		示例。

## 9.2. RESTful API

​		REST 全称 Representational State Transfer，中文译为表述性状态转移。

​		表述性状态转移是一组架构约束条件和原则，满足这些约束条件和原则的应用程序或设计就是 RESTful。

​		作为目前最流行的 API 设计规范，RESTful 被广泛用于 Web 数据接口的设计和开发中。按照 RESTful 的设计原则，每一个网址都代表一种特定的资源，所以地址中一般只是用名词，而不用动词。

​		满足 RESTful 设计原则的 API 就称为 RESTful API。在 RESTful API 中，每个资源都有唯一的地址，资源本身就是方法调用的目标。而对资源的不同操作，可以通过 HTTP 定义的方法来区分。

​		RESTful Web 服务成为基于 SOAP 服务的一个非常有前途的解决方案。

## 9.3. ExPress框架

### 9.3.1. 安装与使用

​		Express 作为目前较为稳定、功能强大的 Node.js 应用框架，提供了一系列实用的特性来帮助开发者创建 Web 应用。Express 不对 Node.js 已有的特性进行二次抽象，只是在 Node.js 框架的基础之上扩展 Web 应用开发所需要的一些功能。

​		使用 Express 框架，开发者可以快速地创建各种复杂的 Web 应用。除了提供常见的 HTTP 服务之外，Express 还提供了 Web 开发中的一些常用功能。

* Cookie 与用户会话
* 路由控制
* 模板解析
* 静态文件服务
* 错误处理
* 日志访问
* 缓存管理
* 插件

​		需要说明的是，此处的插件指的是 Express 支持并拥有的大量第三方插件。借助 Express提供的插件，不仅可以提高项目开发的速度，还可以大大降低应用中代码的耦合性，从而提高开发效率。

### 9.3.2. 项目结构

![Express项目目录结构](https://res.weread.qq.com/wrepub/epub_31403502_111)

​		使用 Express 构建的 Web 项目比较核心的文件如下。

* bin：可执行文件，用于存放项目的启动脚本文件。
* node_modules：项目需要依赖的模块。在该目录下执行 npm install 安装需要的模块。
* public：存放图片、脚本、样式等静态资源文件。
* routes：存放路由文件。
* views：存放页面模板文件，如 ejs 模板或者 jade 模板。
* app.js：应用核心配置文件，也是项目的入口文件。
* package.json：工程配置文件，包含项目依赖配置及开发者信息等内容。
* package-lock.json：项目依赖模块的锁定版本。

### 9.3.3. 路由控制

​		在浏览器中访问 http://127.0.0.1:3000/ 时，应用就会跳转到某个 Express 页面，具体跳转到哪一个页面，是由 Express 的路由控制的。开发者可以在 app.js 文件中进行配置。

​		路由路径与请求方法决定了最终的访问端点，路由路径可以是字符串、字符串模式或正则表达式。

### 9.3.4. 模版引擎

​		所谓模板引擎，就是一个将页面模板和要显示的数据结合起来生成 HTML 代码的转换工具。如果说路由控制方法相当于 MVC 中的控制器（C）的话，那模板引擎就相当于 MVC 中的视图（V）。

​		模板引擎的作用，就是将页面模板和要显示的数据结合起来生成 HTML 页面。它既可以在服务器端运行，又可以在客户端运行，大多数时候它都运行在服务器端，并在服务器端直接解析为 HTML 后再传输给客户端，因此客户端甚至无法判断页面是否是模板引擎生成的。当然，模板引擎也可以在客户端（浏览器）运行，典型的代表就是 XSLT，它以 XML 为输入，然后在客户端被解析成 HTML 页面后再运行。不过，由于浏览器的兼容性问题， XSLT 并不是很流行，目前主流方案还是由服务器来运行模板引擎。

​		模板引擎以数据和页面模板为输入，以生成的 HTML 页面为输出，然后将生成的 HTML 页面返回给控制器，再由控制器交给客户端（浏览器）。ejs 是 Express 提供的一种模板引擎，因为它使用起来十分简单，且与 Express 集成良好，所以可以作为大部分 Web 项目的默认模板。

## 9.4. 开发服务器接口

### 9.4.1. MySQL

​		所谓关系型数据库，是指采用关系模型来组织数据的数据库。关系型数据库通过将数据保存在不同的表中，而不是将所有数据放在一个大仓库中，从而保证了数据的存取速度和安全性。

​		MySQL 使用 SQL 语言来访问数据库，SQL 语言也是最常用的数据库查询和程序设计语言。

### 9.4.2. Postman

​		Postman 是一款功能强大的网页调试和模拟发送 HTTP 请求的工具，支持几乎所有类型的 HTTP 请求。同时，Postman 不仅支持所有的桌面系统，还提供了免费的 Chrome 插件版，从而最大程度上方便开发者。

### 9.4.3. ExPress 整合 MySQL

​		在前后端分离的软件架构中，后端开发人员专注于数据和接口，前端开发者则专注于页面的展示，相互之间并不需要太关注对方的领域，前端与后端交互的唯一方式就是 RESTful API。前端通过 HTTP 发起网络请求，后端在接收到请求后会通过 HTTP 响应网络请求。

## 9.5. 本章小结

​		本章主要介绍了 Node.js、RESTful API、Express 和服务器接口开发。通过 Node.js 技术，前端开发人员也有机会开发出高质量的后台服务。

