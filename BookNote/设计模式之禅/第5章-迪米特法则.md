# 第 5 章 迪米特法则

## 5.1 迪米特法则的定义
　　迪米特法则（Law of Demeter, Lod，也称为最少知识原则（Least Knowledge Principle，LKP）：一个对象应该对其他对象有最少的了解。通俗地讲，一个类应该对自己需要耦合或调用地类知道得最少。

## 5.2 我的知识你知道得越少越好

​	迪米特法则对类地低耦合提出了明确地要求，其包含以下 4 层含义。

1. 只和朋友交流。

   每个对象都必然会与其他对象有耦合关系，两个对象之间地耦合就成为朋友关系，这种关系地类型有很多，例如组合、聚合、依赖等。

   **朋友类**的定义：出现在成员变量、方法的输入输出参数中的类称为成员朋友类，而出现在方法体内部的类不属于朋友类。

   一个类只和朋友交流，不与陌生类交流，不要出现 `getA().getB().getC().getD()`这种情况（在一种极端的情况下允许出现这种访问，即每一个点号后面的返回类型都相同），类鱼类之间的关系是建立在类间的，而不是方法间，因此一个方法尽量不引入一个类中不存在的对象，当然，JDK API 提供的类除外。

2. 朋友之间也是有距离的

   ​	一个累公开的 publish 属性或方法越多，修改时涉及的面也就越大，变更引起的风险扩散也就越大，因此，为了保持朋友间的距离，在设计时需要反复衡量：是否还可以再减少 publish 方法和属性，是否可以修改为 private、package-private（包类型，在类、方法、变量前不加访问权限，则默认为包类型）、protected 等访问权限，是否可以加上 final 关键字等。

   尽量不要对外公开太多的 publish 方法和非静态的 public 变量，尽量内敛，多食用 private 、package-private 、protected 等访问权限。

3. 是自己的就是自己的

   如果一个方法放在本类中，既不增加类间关系，也对本类不产生负面影响，那就放置在被类中。

4. 谨慎使用 Serializable

   这个问题很少出现，即使出现也会立即发现并得到解决。

   在项目中使用 RMI（Remote Method Invocation，远程方法调用）方式传递一个 VO（Value Object，值对象），这个对象就必须实现 Serializable 接口，也就是把需要网络传输的对象进行序列化，否则就会出现 NoSerializableException 异常。如果客户端的 VO 修改了一个属性的访问权限，从 private 变更为 public ，访问的权限扩大了，如果服务器上没有做出相应的变更，就会报序列化失败。

## 5.3 最佳实践

​		迪米特法则的核心观念就是类间解耦，弱耦合，只有弱耦合了以后，类的复用率才可以提高。其要求的结果就是产生了大量的中转或跳转类，导致系统的复杂性提高，同时也为维护带来了难度。

​		在采用迪米特法则时需要反复权衡，即做到让结构清晰，又做到高内聚低耦合。