# 第 2 章 里氏替换原则

## 2.1 爱恨纠葛的父子关系
　　在面向对象的语言中，继承是必不可少的、非常优秀的语言机制，它有如下优点：
* 代码共享，减少创建类的工作量，每个子类都拥有父类的方法和属性；
* 提高代码的重用性；
* 子类可以形似父亲，但又异于父亲。
* 提高代码的可扩展性，实现父类的方法就可以“为所欲为”了，很多开源库的扩展接口都是通过集成父类来完成的；
* 提高产品或项目的开放性。

　　继承的缺点如下：
* 继承是侵入性的。只要继承，就必须拥有父亲的所有属性和方法；
* 降低代码的灵活性。子类必须拥有父类的属性和方法，让子类自由的世界中少了些约束；
* 增加了耦合性。当父类的常量、变量和方法被修改时，需要考虑子类的修改，而且在缺乏规范的环境下，这种修改可能带来非常糟糕的结果--大段的代码需要重构。

　　为了让单一继承原则的优势发挥最大的作用，减少弊端，解决方案就是引入里氏置换原则（Lishov Substitution Principle,LSP）。

　　什么是里氏置换原则？它有两种定义：
* 第一种定义，也是最正宗的定义：If for each  object o1 of type S there is an object o2 of type T such that for all programs P defined in terms of T,the behavior of P is unchanged when o1 is substituted for o2 then S is a subtype of T.（如果对每一个类型为 S 的对象 o1，都有类型为 T 的对象 o2，使得以 T 定义的所有程序 P 在所有的对象 O1 都代换成 o2 时，程序 P 的行为没有发生变化，那么类型 S 是类型 T 的子类型）。
* 第二种定义：Functions that use pointers or references to base classes must be able to use objects of derived classes without knowing it.（所有引用基类的方法必须能透明地使用其子类的对象）。

　　第二个定义是最清晰明确的，通俗点讲，只要父类能出现的地方子类就可以出现，而且替换为子类也不会产生任何错误或异常，使用者可能根本就不需要知道是父类还是子类。但是，反过来就不行了，有子类出现的地方，父类未必就能适应。

## 2.2 纠纷不断，规则压制
　　里氏置换原则为良好的继承定义了一个规范，一句简单的定义包含了 4 层定义。

1. 子类必须完全实现父类的方法

　　在类中调用其他类时务必要使用父类或接口，如果不能使用父类或接口，则说明类的设计已经违背了 LSP 原则。





## 2.3  最佳实践
　　
